<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reweight phylogenetic characters — Reweight • TreeTools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reweight phylogenetic characters — Reweight"><meta name="description" content="Reweight() allows the weights of specific characters in phylogenetic
datasets to be arbitrarily adjusted."><meta property="og:description" content="Reweight() allows the weights of specific characters in phylogenetic
datasets to be arbitrarily adjusted."><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-93LNK4JKY4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-93LNK4JKY4');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeTools</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.0.9005</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/filesystem-navigation.html">File system navigation in R</a></li>
    <li><a class="dropdown-item" href="../articles/load-data.html">Loading phylogenetic data into R</a></li>
    <li><a class="dropdown-item" href="../articles/load-trees.html">Loading phylogenetic trees into R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reweight phylogenetic characters</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeTools/blob/main/R/Reweight.R" class="external-link"><code>R/Reweight.R</code></a></small>
      <div class="d-none name"><code>Reweight.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>Reweight()</code> allows the weights of specific characters in phylogenetic
datasets to be arbitrarily adjusted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Reweight</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">weights</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class <code>phyDat</code>,
or as a matrix in the format produced by <code><a href="MatrixToPhyDat.html">PhyDatToMatrix()</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Unnamed integer vector specifying desired weight of each
character in turn; or named integer vector specifying weights of each
character; unnamed entries will be assigned weight 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>Reweight()</code> returns <code>dataset</code> after adjusting the weights of
the specified characters.
For a matrix, this is attained by repeating each column the <code>weights</code> times.
For a <code>phyDat</code> object, the "weight" attribute will be modified.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This functionality should be employed with care.
The underlying principle of parsimony is that all evolutionary steps are
equivalent.
Setting different weights to different characters is at odds with that
principle, so analysis of a re-weighted matrix using a parsimony-based
framework is arguably no longer parsimony analysis; on the most permissive
view, the criteria used to determine a weighting scheme will always
be arbitrary.</p>
<p>It can be useful to relax the criterion that all evolutionary steps are
equivalent – for example, implied weighting
(Goloboff 1997)
 typically recovers better trees than
equal-weights parsimony (Smith 2019)
.
This said, assigning different weights to different characters tacitly
imposes a model of evolution that differs from that implicit in equal-weights
parsimony.  Whereas probabilistic models can be evaluated by various methods
(e.g. fit, marginal likelihood, posterior predictive power), there are no
principled methods of comparing different models under a parsimony framework.</p>
<p>As such, <code>Reweight()</code> is likely to be useful for a narrow set of uses.
Examples may include:</p><ul><li><p>informal robustness testing, to explore whether certain characters are
more or less influential on the resulting tree;</p></li>
<li><p>Imposing constraints on a dataset, by adding each constraint as a column
in a dataset whose weight exceeds the total amount of data.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Goloboff PA (1997).
“Self-Weighted Optimization: Tree Searches and Character State Reconstructions under Implied Transformation Costs.”
<em>Cladistics</em>, <b>13</b>(3), 225–245.
<a href="https://doi.org/10.1111/j.1096-0031.1997.tb00317.x" class="external-link">doi:10.1111/j.1096-0031.1997.tb00317.x</a>
.<br><br> Smith MR (2019).
“Bayesian and Parsimony Approaches Reconstruct Informative Trees from Simulated Morphological Datasets.”
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632" class="external-link">doi:10.1098/rsbl.2018.0632</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other phylogenetic matrix conversion functions:
<code><a href="Decompose.html">Decompose()</a></code>,
<code><a href="MatrixToPhyDat.html">MatrixToPhyDat()</a></code>,
<code><a href="PhyToString.html">StringToPhyDat()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://orcid.org/0000-0001-5660-1727" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="MatrixToPhyDat.html">MatrixToPhyDat</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Set character 1 to weight 1, character 2 to weight 2; omit character 3</span></span></span>
<span class="r-in"><span><span class="fu">Reweight</span><span class="op">(</span><span class="va">mat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   _1 _1 _2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a  0  2  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b  0  2  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c  1  3  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d  1  3  3</span>
<span class="r-in"><span><span class="co"># Equivalently:</span></span></span>
<span class="r-in"><span><span class="fu">Reweight</span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 3 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 3 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"weight")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"nr")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"nc")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"index")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"levels")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0" "1" "2" "3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"allLevels")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0" "1" "2" "3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"type")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "USER"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrast")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "phyDat"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

