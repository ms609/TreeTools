<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Integer representing shape of a tree — unrootedKeys • TreeTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Integer representing shape of a tree — unrootedKeys" />
<meta property="og:description" content="Returns an integer that uniquely represents the shape of an n-tip
binary tree, ignoring tip labels." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156666971-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156666971-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.5.1.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/filesystem-navigation.html">File system navigation in R</a>
    </li>
    <li>
      <a href="../articles/load-data.html">Loading phylogenetic data into R</a>
    </li>
    <li>
      <a href="../articles/load-trees.html">Loading phylogenetic trees into R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ms609/TreeTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integer representing shape of a tree</h1>
    <small class="dont-index">Source: <a href='https://github.com/ms609/TreeTools/blob/master/R/data.R'><code>R/data.R</code></a>, <a href='https://github.com/ms609/TreeTools/blob/master/R/tree_shape.R'><code>R/tree_shape.R</code></a></small>
    <div class="hidden name"><code>TreeShape.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns an integer that uniquely represents the shape of an <em>n</em>-tip
binary tree, ignoring tip labels.</p>
    </div>

    <pre class="usage"><span class='va'>unrootedKeys</span>

<span class='fu'>RootedTreeShape</span><span class='op'>(</span><span class='va'>tree</span><span class='op'>)</span>

<span class='fu'>RootedTreeWithShape</span><span class='op'>(</span><span class='va'>shape</span>, <span class='va'>nTip</span>, <span class='va'>tipLabels</span><span class='op'>)</span>

<span class='fu'>UnrootedTreeWithShape</span><span class='op'>(</span><span class='va'>shape</span>, <span class='va'>nTip</span>, tipLabels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='va'>nTip</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>UnrootedTreeWithKey</span><span class='op'>(</span><span class='va'>key</span>, <span class='va'>nTip</span>, tipLabels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='va'>nTip</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>UnrootedTreeShape</span><span class='op'>(</span><span class='va'>tree</span><span class='op'>)</span>

<span class='fu'>UnrootedTreeKey</span><span class='op'>(</span><span class='va'>tree</span>, asInteger <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>.UnrootedKeys</span><span class='op'>(</span><span class='va'>nTip</span><span class='op'>)</span>

<span class='fu'>UnrootedKeys</span><span class='op'>(</span><span class='va'>...</span>, envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>NUnrootedShapes</span><span class='op'>(</span><span class='va'>nTip</span><span class='op'>)</span>

<span class='fu'>NRootedShapes</span><span class='op'>(</span><span class='va'>nTip</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree</th>
      <td><p>A tree of class <code><a href='https://rdrr.io/pkg/ape/man/read.tree.html'>phylo</a></code>.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Integer specifying shape of tree, perhaps generated by
<code>TreeShape()</code>.</p></td>
    </tr>
    <tr>
      <th>nTip</th>
      <td><p>Integer specifying number of tips.</p></td>
    </tr>
    <tr>
      <th>tipLabels</th>
      <td><p>Character vector listing the labels assigned to each tip
in a tree, perhaps obtained using <code><a href='TipLabels.html'>TipLabels()</a></code>.</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>Integer specifying the <em>key</em> (not number) of an unrooted tree.</p></td>
    </tr>
    <tr>
      <th>asInteger</th>
      <td><p>Logical specifying whether to coerce the return value to
mode <code>integer</code>: only possible for values &lt; 2^31.
If <code>FALSE</code>, values will have class <code>integer64</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Value of <code>nTip</code>, to pass to memoized <code>.UnrootedKeys</code>.</p></td>
    </tr>
    <tr>
      <th>envir</th>
      <td><p>Unused; passed to <code>addMemoization</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code>unrootedKeys</code> is a list of length 22; each
entry is a vector of integers corresponding to they keys (not shape numbers)
of the different unrooted tree shapes with <code>nTip</code> leaves.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>TreeShape()</code> returns an integer specifying the shape of a tree,
ignoring tip labels.</p>
<p><code>RootedTreeWithShape()</code> returns a tree of class <code>phylo</code>
corresponding to the shape provided.  Tips are unlabelled.</p>
<p><code>UnrootedTreeWithShape()</code> returns a tree of class <code>phylo</code>
corresponding to the shape provided.  Tips are unlabelled.</p>
<p><code>UnrootedTreeWithKey()</code> returns a tree of class <code>phylo</code> corresponding
to the key provided.  Tips are unlabelled.</p>
<p><code>UnrootedKeys()</code> returns a vector of integers corresponding to the
keys (not shape numbers) of unrooted tree shapes with <code>nTip</code> tips.
It is a wrapper to <code>.UnrootedKeys()</code>, with memoization, meaning that results
once calculated are cached and need not be calculated on future calls to
the function.</p>
<p><code>NUnrootedShapes()</code> returns an object of class <code>integer64</code> specifying
the number of unique unrooted tree shapes with <code>nTip</code> (&lt; 61) tips.</p>
<p><code>NRootedShapes()</code> returns an object of class <code>integer64</code> specifying
the number of unique rooted tree shapes with <code>nTip</code> (&lt; 56) leaves.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Rooted trees are numbered working up from the root.</p>
<p>The root node divides <em>n</em> tips into two subtrees.  The smaller subtree
may contain $a = 1, 2, ..., n/2$ tips, leaving $b = n - a$ tips in
These options are worked through in turn.</p>
<p>For the first shape of the smaller subtree, work through each possible shape
for the larger subtree.  Then, move to the next shape of the smaller subtree,
and work through each possible shape of the larger subtree.</p>
<p>Stop when the desired topology is encountered.</p>
<p>Unrooted trees are numbered less elegantly.  Each cherry (i.e. node
subtending a pair of tips) is treated in turn.  The subtended tips are
removed, and the node treated as the root of a rooted tree.  The number of
this rooted tree is then calculated.  The tree is assigned a <em>key</em>
corresponding to the lowest such value.  The keys of all unrooted tree shapes
on <em>n</em> tips are ranked, and the unrooted tree shape is assigned a <em>number</em>
based on the rank order of its key among all possible keys, counting from
zero.</p>
<p>If <code>UnrootedTreeShape()</code> or <code>UnrootedTreeKey()</code> is passed a rooted tree,
the position of the root will be ignored.</p>
<p>The number of unlabelled binary rooted trees corresponds to the
<a href='https://oeis.org/A001190'>Wedderburn-Etherington numbers</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Unique number for a labelled tree: <code><a href='TreeNumber.html'>TreeNumber()</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Martin R. Smith (<a href='mailto:martin.smith@durham.ac.uk'>martin.smith@durham.ac.uk</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'>RootedTreeShape</span><span class='op'>(</span><span class='fu'><a href='GenerateTree.html'>PectinateTree</a></span><span class='op'>(</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> integer64</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>RootedTreeWithShape</span><span class='op'>(</span><span class='fl'>0</span>, nTip <span class='op'>=</span> <span class='fl'>8L</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='TreeShape-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>NRootedShapes</span><span class='op'>(</span><span class='fl'>8L</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> integer64</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 23</span>
<span class='r-in'><span class='co'># Shapes are numbered from 0 to NRootedShapes(n) - 1.  The maximum shape is:</span></span>
<span class='r-in'><span class='fu'>RootedTreeShape</span><span class='op'>(</span><span class='fu'><a href='GenerateTree.html'>BalancedTree</a></span><span class='op'>(</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> integer64</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 22</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Unique shapes of unrooted trees:</span></span>
<span class='r-in'><span class='fu'>NUnrootedShapes</span><span class='op'>(</span><span class='fl'>8L</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> integer64</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 4</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Keys of these trees:</span></span>
<span class='r-in'><span class='fu'>UnrootedKeys</span><span class='op'>(</span><span class='fl'>8L</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 1 2 4</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># A tree may be represented by multiple keys.</span></span>
<span class='r-in'><span class='co'># For a one-to-one correspondence, use a number instead:</span></span>
<span class='r-in'><span class='va'>unrootedShapes8</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'>NUnrootedShapes</span><span class='op'>(</span><span class='fl'>8L</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>allShapes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>unrootedShapes8</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1L</span>,</span>
<span class='r-in'>                    <span class='va'>UnrootedTreeWithShape</span>, <span class='fl'>8L</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>allShapes</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='TreeShape-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>allShapes</span>, <span class='va'>UnrootedTreeShape</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 1 2 3</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>allShapes</span>, <span class='va'>UnrootedTreeKey</span>, asInteger <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'># Key &gt;= number</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 1 2 4</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># If numbers larger than 2&gt;31 are required, sapply needs a little help</span></span>
<span class='r-in'><span class='co'># with 64-bit integers:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>allShapes</span>, <span class='va'>UnrootedTreeKey</span><span class='op'>)</span>, class <span class='op'>=</span> <span class='st'>'integer64'</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> integer64</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0 1 2 4</span>
<span class='r-in'></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://smithlabdurham.github.io/'>Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '6078115fdeb422f23fe2f8c478c70150',
    indexName: 'treetools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


