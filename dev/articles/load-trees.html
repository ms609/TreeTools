<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Loading phylogenetic trees into R • TreeTools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loading phylogenetic trees into R">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-93LNK4JKY4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-93LNK4JKY4');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeTools</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.13.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/filesystem-navigation.html">File system navigation in R</a></li>
    <li><a class="dropdown-item" href="../articles/load-data.html">Loading phylogenetic data into R</a></li>
    <li><a class="dropdown-item" href="../articles/load-trees.html">Loading phylogenetic trees into R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeTools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Loading phylogenetic trees into R</h1>
                        <h4 data-toc-skip class="author">Martin R. Smith
<a href="mailto:martin.smith@durham.ac.uk" class="email">martin.smith@durham.ac.uk</a>
</h4>
            
            <h4 data-toc-skip class="date">2025-04-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeTools/blob/master/vignettes/load-trees.Rmd" class="external-link"><code>vignettes/load-trees.Rmd</code></a></small>
      <div class="d-none name"><code>load-trees.Rmd</code></div>
    </div>

    
    
<p>If a tree is available in a text-based format, it should not be too
difficult to load into R.</p>
<div class="section level2">
<h2 id="manual-entry">Manual entry<a class="anchor" aria-label="anchor" href="#manual-entry"></a>
</h2>
<p>A straightforward, if cumbersome, way to enter trees into R is by
manual text entry:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myTree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"((A, B), ((C, D), (E, F)));"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myTree</span><span class="op">)</span></span></code></pre></div>
<p><img src="load-trees_files/figure-html/text-entry-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>Beware common gotchas when entering text:</p>
<ul>
<li><p>Ensure that the tree string ends in a semi-colon.</p></li>
<li><p>Make sure that brackets are matched. Some text editors, such as
<a href="https://posit.co/" class="external-link">RStudio</a> or <a href="https://notepad-plus-plus.org/" class="external-link">Notepad++</a>, contain built-in
syntax highlighting that will highlight the counterpart to each
parenthesis as you type.</p></li>
<li><p>Look out for ((double brackets)) or brackets enclosing a single
node: the resultant ‘invisible nodes’ can cause R to crash.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">badTree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"((A, B), (((C, D), ((E), F))));"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">badTree</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">nodelabels</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="load-trees_files/figure-html/double-bracket-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>The text is expected in Newick format, so can contain edge lengths -
but edge lengths must be included for every edge of the tree, or they
will be ignored.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myTree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span></span>
<span>  text <span class="op">=</span> <span class="st">"((A:1, B:1):2, ((C:1, D:1):2, (E:1, F:1):2):4);"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myTree</span><span class="op">)</span></span></code></pre></div>
<p><img src="load-trees_files/figure-html/branch-lengths-1.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="from-a-file">From a file<a class="anchor" aria-label="anchor" href="#from-a-file"></a>
</h2>
<p>First off, make sure that you are comfortable <a href="filesystem-navigation.html">telling R where to find a
file</a>.</p>
<div class="section level3">
<h3 id="nexus-files">Nexus files<a class="anchor" aria-label="anchor" href="#nexus-files"></a>
</h3>
<p>You can load trees from a nexus file using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"my_file_name.nex"</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.nexus.html" class="external-link">read.nexus</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></code></pre></div>
<p>If the file contains multiple trees, this will return a list of all
trees in the file, with the class <code>multiPhylo</code>. If there is a
single tree, then this will be returned as a tree of class
<code>phylo</code> unless the option
<code>force.multiPhylo = TRUE</code>. This can be useful when an unknown
number of trees are to be processed in bulk, for example by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.nexus.html" class="external-link">read.nexus</a></span><span class="op">(</span><span class="va">filename</span>, force.multiPhylo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu">ape</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="newick-files">Newick files<a class="anchor" aria-label="anchor" href="#newick-files"></a>
</h3>
<p>Newick trees can be read with <code>ape::read.tree(filename)</code>;
<code>phytools::read.newick(filename)</code> does not report an error
when a ‘node’ has a single descendant (which will often denote a
misspecified tree).</p>
</div>
<div class="section level3">
<h3 id="trees-from-tnt">Trees from TNT<a class="anchor" aria-label="anchor" href="#trees-from-tnt"></a>
</h3>
<p>Trees saved using <a href="https://www.lillo.org.ar/phylogeny/tnt/" class="external-link">TNT</a> can be opened in
R using <code><a href="../reference/ReadTntTree.html">ReadTntTree()</a></code>.</p>
<p>Trees should be saved in parenthetical format (TNT command
<code>tsav*</code>), rather than TNT’s compressed format (TNT command
<code>tsav</code>).</p>
<p>The TNT command <code>taxname=</code> will write taxon names to file,
which results in larger but easier to read files. Trees in such a file
will be read using the terminal names saved within the file. The TNT
command <code>taxname-</code> saves just the numbers of the terminals.
In order for the trees to be reunited with the names of their tips,
terminal labels will be read from the linked matrix file listed in the
first line of the .tre file. Ensure that this file exists in the
expected location. If it does not, use
<code>ReadTntTree(treeFile, relativePath = '../path/to/tipNameFile')</code>,
or <code>tipLabels</code> to manually specify the names of the tips
(e.g.
<code>ReadTntTree(treeFile, tipLabels = c('outgroup', letters[1:8])</code>).</p>
</div>
<div class="section level3">
<h3 id="other-formats">Other formats<a class="anchor" aria-label="anchor" href="#other-formats"></a>
</h3>
<p>Are there other formats that should be listed here? Please let me
know by <a href="https://github.com/ms609/TreeSearch/issues/new?title=Loading%20trees" class="external-link">opening
an issue</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="export-write-trees">Export (write) trees<a class="anchor" aria-label="anchor" href="#export-write-trees"></a>
</h2>
<p>To save a tree to a text file, use
<code>ape::write.tree(tree, file='filename.txt')</code> for Newick
format (widely supported by most phylogenetic software), or
<code>ape::write.nexus(tree, file='filename.nex')</code> for Nexus
format.</p>
</div>
<div class="section level2">
<h2 id="what-next">What next?<a class="anchor" aria-label="anchor" href="#what-next"></a>
</h2>
<p>You might want to:</p>
<ul>
<li><p><a href="load-data.html">Load phylogenetic data</a> into
R.</p></li>
<li><p>Conduct parsimony search using Brazeau, Guillerme &amp; Smith’s
<a href="https://ms609.github.io/TreeSearch/articles/tree-search.html" class="external-link">approach
to inapplicable data</a>, or using <a href="https://ms609.github.io/TreeSearch/articles/profile.html" class="external-link">Profile
parsimony</a>.</p></li>
<li><p><a href="https://ms609.github.io/TreeDist/articles/Using-TreeDist.html" class="external-link">Calculate
distances</a> between pairs of trees.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
