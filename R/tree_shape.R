#' Integer representing shape of a tree
#'
#' Returns an integer that uniquely represents the _shape_ of an _n_-tip
#' binary tree, ignoring tip labels.
#'
#' Rooted trees are numbered working up from the root.
#'
#' The root node divides _n_ tips into two subtrees.  The smaller subtree
#' may contain $a = 1, 2, ..., n/2$ tips, leaving $b = n - a$ tips in
#' These options are worked through in turn.
#'
#' For the first shape of the smaller subtree, work through each possible shape
#' for the larger subtree.  Then, move to the next shape of the smaller subtree,
#' and work through each possible shape of the larger subtree.
#'
#' Stop when the desired topology is encountered.
#'
#' @template treeParam
#'
#' @return `TreeShape` returns an integer specifying the shape of a tree,
#' ignoring tip labels.
#'
#' @template MRS
#' @name TreeShape
#' @export
RootedTreeShape <- function (tree) {
  edge <- tree$edge
  nTip <- NTip(tree)
  edge <- PostorderEdges(edge[, 1], edge[, 2], nTip = nTip)

  edge_to_rooted_shape(edge[[1]], edge[[2]], nTip)

}

#' @rdname TreeShape
#' @param shape Integer specifying shape of tree, perhaps generated by
#'  `TreeShape`.
#' @param nTip Integer specifying number of tips.
#' @return `TreeWithShape` returns a tree of class `phylo` corresponding to the
#' shape provided.  Tips are unlabelled.
#' @export
RootedTreeWithShape <- function (shape, nTip) {
  structure(list(edge = rooted_shape_to_edge(shape, nTip),
                 Nnode = nTip - 1,
                 tip.label = rep('', nTip)),
            class = 'phylo')
}

#' @rdname TreeShape
#' @return `RootedTreeShapes` returns an integer specifying the number of unique
#' rooted tree shapes with `nTip` tips.
#' @export
NRootedShapes <- function (nTip) {
  n_rooted_tree_shapes(as.integer(nTip))
}
